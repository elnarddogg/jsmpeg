/*! jsmpeg - 0.1.0 - Dominic Szablewski - 36eba78 - 2014-08-21 */
var _MOJO={},MOJO={};_MOJO.Shared=function(a,b){function c(a){return a.length}function d(b){return a.keys(b)}function e(a){return b.prototype.shift.call(a)}function f(a){return a instanceof b?a:a!==i?[a]:[]}function g(a,b){return{get:a,set:b,configurable:!0}}function h(a){return(a||{})[j]?a[j]:a}var i,j="handleMOJO";return{length:c,keys:d,shift:e,ensureArray:f,descriptor:g,getHandlerFunc:h}}(Object,Array),_MOJO.EventHandler=function(a){function b(a,b,c){var e=this;e.handler=a,e.context=b,e.active=!0,e.callback=function(){},e.args=d(c)}var c=a.Shared,d=c.ensureArray;return b.prototype={invoke:function(a,b){var c=this,e=c.handler;if(c.active&&!a.isBreak&&!a.shouldSkip(e)){var f=c.args.concat(d(b));f.unshift(a),e.apply(c.context,f),c.callback(a,e)}}},b}(_MOJO),_MOJO.Event=function(a,b){function c(b,c){var d=this;d.isBreak=e,d.cancelBubble=e,d.defaultPrevented=e,d.skipHandlers=[],d.target=b,d.type=c,d.timeStamp=a.now()}var d=!0,e=!1,f=b.Shared,g=f.ensureArray,h=f.getHandlerFunc;return c.prototype={skip:function(a){var b=this.skipHandlers;g(a).forEach(function(a){b.push(h(a))})},shouldSkip:function(a){return this.skipHandlers.indexOf(a)>=0},"break":function(){this.isBreak=d},preventDefault:function(){this.defaultPrevented=d},stopPropagation:function(){this.cancelBubble=d}},c}(Date,_MOJO),_MOJO.When=function(a,b,c){function d(a,b){return l(a).map(function(a){return a.handler}).indexOf(b)}function e(a,c){(a instanceof b?a:a.split(" ")).forEach(c)}function f(a,b){return a===b?null:a}var g=c.Shared,h=c.EventHandler,i=c.Event,j=g.keys,k=g.shift,l=g.ensureArray,m=g.length,n=g.getHandlerFunc,o={once:function(){var a=this,b=a._when(arguments);return b.forEach(function(a){a.callback=function(){this.active=!1}}),a},when:function(){var a=this;return a._when(arguments),a},_when:function(a){var b=this,c=k(a),d=m(a)>1?k(a):d,g=[],i=k(a),j=n(i),l=f(i,j);return e(c,function(a,c){g.push(new h(j,l,d)),b._addHandler(a,g[c])}),g},happen:function(a,b){var c=this;return a=c._ensureEType(a),e(a,function(a){var d=c._getHandlers(a,!0),e=new i(c,a);d.filter(function(a){return a.invoke(e,b),!a.active}).forEach(function(b){c._removeHandler(c._getHandlers(a),b.handler)})}),c},dispel:function(a,b){var c=this,d=c._getHandlers(),f=n(b);return a=c._ensureEType(a),e(a,function(a){f?c._removeHandler(d[a],f):delete d[a]}),c},_ensureEType:function(a){return a||j(this._getHandlers()).join(" ")},_getHandlers:function(b,c){var d=this,e=d.handlers=d.handlers||{},f=b?e[b]=e[b]||[]:e;return c?b?f.slice():a.create(f):f},_addHandler:function(a,b){var c=this;c._getHandlers(a).push(b)},_removeHandler:function(a,b){var c=d(a,b);c>=0&&a.splice(c,1)}};return o}(Object,Array,_MOJO),MOJO=function(a){function b(a){a=a||{};var c=this;b.Each(a,function(a,b){c[b]=a}),b.Construct(c)}var c=b.prototype=Object.create(a.When);return c.each=function(a){var c=this;return b.Each(c,a,c.keys),c},c.set=function(a,b){var c=this;return c[a]=b,c.happen("set",a),c},c.remove=function(a){var b=this;return delete b[a],b.happen("remove",a),b},b}(_MOJO),MOJO.Each=function(a){function b(a,b,c){(c||d(a)).forEach(function(c,d){b(a[c],c,d)})}var c=a.Shared,d=c.keys;return b}(_MOJO),MOJO.Create=function(a,b){function c(c){var d=a.create(b.prototype);return b.Each(c,function(a,b){d[b]=a}),d}return c}(Object,MOJO),MOJO.Construct=function(a,b){function c(b){var c={};a.defineProperties(b,{handlers:f(function(){return c}),keys:f(function(){return e(b)}),length:f(function(){return g(b.keys)}),handleMOJO:{value:(b.handleMOJO||function(){}).bind(b),configurable:!0}})}var d=b.Shared,e=d.keys,f=d.descriptor,g=d.length;return c}(Object,_MOJO),function(a){"object"==typeof exports?module.exports=a:window.MOJO=a}(MOJO),window.requestAnimationFrame=function(a,b,c,d){function e(){return b.now()-g}var f="equestAnimationFrame",g=b.now();return(a["r"+f]||a["webkitR"+f]||a["mozR"+f]||a["oR"+f]||a["msR"+f]||function(a){var b=c(function(){a(e()),d(b)},1e3/60)}).bind(null)}(window,Date,setTimeout,clearTimeout),window.JSMPEG=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(a,b){b=b||{};var d=this;p.Construct(d),d.autoplay=!!b.autoplay,d.loop=!!b.loop,d.bwFilter=b.bwFilter||!1;try{d.canvas=r(a),d.canvasContext=d.canvas.getContext("2d"),d.container=d.canvas.parentNode}catch(e){throw e}d.setFPS(b.fps),d._init(),c.defineProperties(d,{elapsedMacro:{get:function(){return Math.floor(d.elapsed/1e3)}},elapsedMicro:{get:function(){return d.elapsed%1e3}}}),d.loadVideo(b.video),console.log(d)}function r(a){var c=b.querySelector(a),d=c.getBoundingClientRect(),e=b.createElement("canvas");return e.setAttribute("width",d.width),e.setAttribute("height",d.height),e.style.width=d.width+"px",e.style.height=d.height+"px",c.appendChild(e),e}function s(a){var b=this;b.bytes=new m(a),b.length=b.bytes.length,b.writePos=b.bytes.length,b.index=0}q.prototype=p.Create({_init:function(){var a=this;a.customIntraQuantMatrix=new m(64),a.customNonIntraQuantMatrix=new m(64),a.blockData=new l(64),a.waitForIntraFrame=!0,a.socketBufferSize=524288,a.onlostconnection=t,a.isRecording=!1,a.recorderWaitForIntraFrame=!1,a.recordedFrames=0,a.recordedSize=0,a.didStartRecordingCallback=t,a.recordBuffers=[],a.dcPredictorY,a.dcPredictorCr,a.dcPredictorCb,a.currentY=t,a.currentCr=t,a.currentCb=t,a.currentRGBA=t,a.pictureCodingType=0,a.forwardY=t,a.forwardCr=t,a.forwardCb=t,a.fullPelForward=!1,a.forwardFCode=0,a.forwardRSize=0,a.forwardF=0,a.quantizerScale=0,a.sliceBegin=!1,a.macroblockAddress=0,a.mbRow=0,a.mbCol=0,a.macroblockType=0,a.macroblockIntra=!1,a.macroblockMotFw=!1,a.motionFwH=0,a.motionFwV=0,a.motionFwHPrev=0,a.motionFwVPrev=0,a.benchframe=t,a.pictureRate=30,a.lateTime=0,a.firstSequenceHeader=0,a.targetTime=0,a.lastTime=0,a.now=0,a.elapsed=0,a.lastTic=0,a.when(A,function(){a.elapsed=0,a.now=0,a.lastTime=0,a.lastTic=0})}});var t=null,u="onload",v="play",w="pause",x="timing",y="tic",z="decodeFrame",A="stop",B="end",C="benchframe",D="prototype",E=1,F=[0,23.976,24,25,29.97,30,50,59.94,60,0,0,0,0,0,0,0],G=new m([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),H=new m([8,16,19,22,26,27,29,34,16,16,22,24,27,29,34,37,19,22,26,27,29,34,34,38,22,22,26,27,29,34,37,40,22,26,27,29,32,35,40,48,26,27,29,32,35,40,48,58,26,27,29,34,38,46,56,69,27,29,35,38,46,56,69,83]),I=new m([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),J=new m([32,44,42,38,32,25,17,9,44,62,58,52,44,35,24,12,42,58,55,49,42,33,23,12,38,52,49,44,38,30,20,10,32,44,42,38,32,25,17,9,25,35,33,30,25,20,14,7,17,24,23,20,17,14,9,5,9,12,12,10,9,7,5,2]),K=new k([3,6,0,9,12,0,0,0,1,15,18,0,21,24,0,27,30,0,33,36,0,0,0,3,0,0,2,39,42,0,45,48,0,0,0,5,0,0,4,51,54,0,57,60,0,0,0,7,0,0,6,63,66,0,69,72,0,75,78,0,81,84,0,-1,87,0,-1,90,0,93,96,0,99,102,0,105,108,0,111,114,0,0,0,9,0,0,8,117,120,0,123,126,0,129,132,0,135,138,0,0,0,15,0,0,14,0,0,13,0,0,12,0,0,11,0,0,10,141,-1,0,-1,144,0,147,150,0,153,156,0,159,162,0,165,168,0,171,174,0,177,180,0,183,-1,0,-1,186,0,189,192,0,195,198,0,201,204,0,207,210,0,213,216,0,219,222,0,0,0,21,0,0,20,0,0,19,0,0,18,0,0,17,0,0,16,0,0,35,0,0,34,0,0,33,0,0,32,0,0,31,0,0,30,0,0,29,0,0,28,0,0,27,0,0,26,0,0,25,0,0,24,0,0,23,0,0,22]),L=new j([3,6,0,-1,9,0,0,0,1,0,0,17]),M=new j([3,6,0,9,12,0,0,0,10,15,18,0,0,0,2,21,24,0,0,0,8,27,30,0,33,36,0,-1,39,0,0,0,18,0,0,26,0,0,1,0,0,17]),N=new j([3,6,0,9,15,0,12,18,0,24,21,0,0,0,12,27,30,0,0,0,14,39,42,0,36,33,0,0,0,4,0,0,6,54,48,0,45,51,0,0,0,8,0,0,10,-1,57,0,0,0,1,60,63,0,0,0,30,0,0,17,0,0,22,0,0,26]),O=new k([6,3,0,9,18,0,12,15,0,24,33,0,36,39,0,27,21,0,30,42,0,60,57,0,54,48,0,69,51,0,81,75,0,63,84,0,45,66,0,72,78,0,0,0,60,105,120,0,132,144,0,114,108,0,126,141,0,87,93,0,117,96,0,0,0,32,135,138,0,99,123,0,129,102,0,0,0,4,90,111,0,0,0,8,0,0,16,0,0,44,150,168,0,0,0,28,0,0,52,0,0,62,183,177,0,156,180,0,0,0,1,165,162,0,0,0,61,0,0,56,171,174,0,0,0,2,0,0,40,153,186,0,0,0,48,192,189,0,147,159,0,0,0,20,0,0,12,240,249,0,0,0,63,231,225,0,195,219,0,252,198,0,0,0,24,0,0,36,0,0,3,207,261,0,243,237,0,204,213,0,210,234,0,201,228,0,216,222,0,258,255,0,264,246,0,-1,282,0,285,291,0,0,0,33,0,0,9,318,330,0,306,348,0,0,0,5,0,0,10,279,267,0,0,0,6,0,0,18,0,0,17,0,0,34,339,357,0,309,312,0,270,276,0,327,321,0,351,354,0,303,297,0,294,288,0,300,273,0,342,345,0,315,324,0,336,333,0,363,375,0,0,0,41,0,0,14,0,0,21,372,366,0,360,369,0,0,0,11,0,0,19,0,0,7,0,0,35,0,0,13,0,0,50,0,0,49,0,0,58,0,0,37,0,0,25,0,0,45,0,0,57,0,0,26,0,0,29,0,0,38,0,0,53,0,0,23,0,0,43,0,0,46,0,0,42,0,0,22,0,0,54,0,0,51,0,0,15,0,0,30,0,0,39,0,0,47,0,0,55,0,0,27,0,0,59,0,0,31]),P=new k([3,6,0,12,9,0,0,0,0,18,15,0,24,21,0,0,0,-1,0,0,1,27,30,0,36,33,0,0,0,2,0,0,-2,42,45,0,48,39,0,60,54,0,0,0,3,0,0,-3,51,57,0,-1,69,0,81,75,0,78,63,0,72,66,0,96,84,0,87,93,0,-1,99,0,108,105,0,0,0,-4,90,102,0,0,0,4,0,0,-7,0,0,5,111,123,0,0,0,-5,0,0,7,114,120,0,126,117,0,0,0,-6,0,0,6,153,162,0,150,147,0,135,138,0,156,141,0,129,159,0,132,144,0,0,0,10,0,0,9,0,0,8,0,0,-8,171,198,0,0,0,-9,180,192,0,168,183,0,165,186,0,174,189,0,0,0,-10,177,195,0,0,0,12,0,0,16,0,0,13,0,0,14,0,0,11,0,0,15,0,0,-16,0,0,-12,0,0,-14,0,0,-15,0,0,-11,0,0,-13]),Q=new j([6,3,0,18,15,0,9,12,0,0,0,1,0,0,2,27,24,0,21,30,0,0,0,0,36,33,0,0,0,4,0,0,3,39,42,0,0,0,5,0,0,6,48,45,0,51,-1,0,0,0,7,0,0,8]),R=new j([6,3,0,12,9,0,18,15,0,24,21,0,0,0,2,0,0,1,0,0,0,30,27,0,0,0,3,36,33,0,0,0,4,42,39,0,0,0,5,48,45,0,0,0,6,51,-1,0,0,0,7,0,0,8]),S=new l([3,6,0,12,9,0,0,0,1,21,24,0,18,15,0,39,27,0,33,30,0,42,36,0,0,0,257,60,66,0,54,63,0,48,57,0,0,0,513,51,45,0,0,0,2,0,0,3,81,75,0,87,93,0,72,78,0,96,90,0,0,0,1025,69,84,0,0,0,769,0,0,258,0,0,1793,0,0,65535,0,0,1537,111,108,0,0,0,1281,105,102,0,117,114,0,99,126,0,120,123,0,156,150,0,162,159,0,144,147,0,129,135,0,138,132,0,0,0,2049,0,0,4,0,0,514,0,0,2305,153,141,0,165,171,0,180,168,0,177,174,0,183,186,0,0,0,2561,0,0,3329,0,0,6,0,0,259,0,0,5,0,0,770,0,0,2817,0,0,3073,228,225,0,201,210,0,219,213,0,234,222,0,216,231,0,207,192,0,204,189,0,198,195,0,243,261,0,273,240,0,246,237,0,249,258,0,279,276,0,252,255,0,270,282,0,264,267,0,0,0,515,0,0,260,0,0,7,0,0,1026,0,0,1282,0,0,4097,0,0,3841,0,0,3585,315,321,0,333,342,0,312,291,0,375,357,0,288,294,0,-1,369,0,285,303,0,318,363,0,297,306,0,339,309,0,336,348,0,330,300,0,372,345,0,351,366,0,327,354,0,360,324,0,381,408,0,417,420,0,390,378,0,435,438,0,384,387,0,0,0,2050,396,402,0,465,462,0,0,0,8,411,399,0,429,432,0,453,414,0,426,423,0,0,0,10,0,0,9,0,0,11,0,0,5377,0,0,1538,0,0,771,0,0,5121,0,0,1794,0,0,4353,0,0,4609,0,0,4865,444,456,0,0,0,1027,459,450,0,0,0,261,393,405,0,0,0,516,447,441,0,516,519,0,486,474,0,510,483,0,504,498,0,471,537,0,507,501,0,522,513,0,534,531,0,468,477,0,492,495,0,549,546,0,525,528,0,0,0,263,0,0,2562,0,0,2306,0,0,5633,0,0,5889,0,0,6401,0,0,6145,0,0,1283,0,0,772,0,0,13,0,0,12,0,0,14,0,0,15,0,0,517,0,0,6657,0,0,262,540,543,0,480,489,0,588,597,0,0,0,27,609,555,0,606,603,0,0,0,19,0,0,22,591,621,0,0,0,18,573,576,0,564,570,0,0,0,20,552,582,0,0,0,21,558,579,0,0,0,23,612,594,0,0,0,25,0,0,24,600,615,0,0,0,31,0,0,30,0,0,28,0,0,29,0,0,26,0,0,17,0,0,16,567,618,0,561,585,0,654,633,0,0,0,37,645,648,0,0,0,36,630,636,0,0,0,34,639,627,0,663,666,0,657,624,0,651,642,0,669,660,0,0,0,35,0,0,267,0,0,40,0,0,268,0,0,266,0,0,32,0,0,264,0,0,265,0,0,38,0,0,269,0,0,270,0,0,33,0,0,39,0,0,7937,0,0,6913,0,0,7681,0,0,4098,0,0,7425,0,0,7169,0,0,271,0,0,274,0,0,273,0,0,272,0,0,1539,0,0,2818,0,0,3586,0,0,3330,0,0,3074,0,0,3842]),T=1,U=2,V=3,W=179,X=1,Y=175,Z=0,$=181,_=178,ab=[null,L,M,N];return function(a){a[D].play=function(){var a=this;if(!a.playing)return a.targetTime=d.now(),a.playing=!0,a.scheduleNextFrame(),a.happen(v),a},a[D].pause=function(){var a=this;return a.playing=!1,a.happen(w),a},a[D].stop=function(){var a=this;return a.buffer&&(a.buffer.index=a.firstSequenceHeader),a.playing=!1,a.client&&(a.client.close(),a.client=t),a.happen(A),a},a[D].setFPS=function(a){var b=this;return b.scheduleFPSChange(a),b}}(q),function(a){a[D].canRecord=function(){var a=this;return a.client&&a.client.readyState==a.client.OPEN},a[D].startRecording=function(a){var b=this;if(b.canRecord()){b.discardRecordBuffers(),b.isRecording=!0,b.recorderWaitForIntraFrame=!0,b.didStartRecordingCallback=a||t,b.recordedFrames=0,b.recordedSize=0;var c=b.width>>4,d=(15&b.width)<<4|b.height>>8,e=255&b.height;b.recordBuffers.push(new m([0,0,1,179,c,d,e,19,255,255,225,88,0,0,1,184,0,8,0,0,0,0,1,0]))}},a[D].recordFrameFromCurrentBuffer=function(){var a=this;if(a.isRecording){if(a.recorderWaitForIntraFrame){if(a.pictureCodingType!=T)return;a.recorderWaitForIntraFrame=!1,a.didStartRecordingCallback&&a.didStartRecordingCallback(a)}a.recordedFrames++,a.recordedSize+=a.buffer.writePos,a.recordBuffers.push(new m(a.buffer.bytes.subarray(0,a.buffer.writePos)))}},a[D].discardRecordBuffers=function(){var a=this;a.recordBuffers=[],a.recordedFrames=0},a[D].stopRecording=function(){var a=this,b=new o(a.recordBuffers,{type:"video/mpeg"});return a.discardRecordBuffers(),a.isRecording=!1,b}}(q),function(a){a[D].loadVideo=function(a){if(!a)throw new f("video url is required");var b=this;b.url=a;var c=new e;c.onreadystatechange=function(){c.readyState==c.DONE&&200==c.status&&b.loadCallback(c.response)},c.onprogress=b.updateLoader.bind(b),c.open("GET",a,!0),c.responseType="arraybuffer",c.send()},a[D].updateLoader=function(a){var b=this,c=a.loaded/a.total,d=b.canvas.width,e=b.canvas.height,f=b.canvasContext;f.fillStyle="#222",f.fillRect(0,0,d,e),f.fillStyle="#fff",f.fillRect(0,e-e*c,d,e*c)},a[D].loadCallback=function(a){var b=this;b.buffer=new s(a),b.findStartCode(W),b.firstSequenceHeader=b.buffer.index,b.decodeSequenceHeader(),b.nextFrame(),b.autoplay&&b.play(),b.happen(u)}}(q),function(a){a[D].readCode=function(a){var b=this,c=0;do c=a[c+b.buffer.getBits(1)];while(c>=0&&0!=a[c]);return a[c+2]},a[D].findStartCode=function(a){for(var b=this,c=0;;)if(c=b.buffer.findNextMPEGStartCode(),c==a||c==s.NOT_FOUND)return c;return s.NOT_FOUND},a[D].fillArray=function(a,b){for(var c=0,d=a.length;d>c;c++)a[c]=b}}(q),function(b){b[D].nextFrame=function(){var a=this;if(a.buffer)for(;;){var b=a.buffer.findNextMPEGStartCode();if(b==W)a.decodeSequenceHeader();else{if(b==Z){if(a.playing){var c=a.elapsedMacro,d=a.elapsedMicro,e=a.elapsed;a.scheduleNextFrame(),a.happen(x,[d,e]),a.lastTic!==c&&(a.lastTic=c,a.happen(y,[c,e]))}return a.decodePicture(),a.canvas}if(b==s.NOT_FOUND)return a.happen(B),a.stop(),a.loop&&a.sequenceStarted&&a.play(),t}}},b[D].scheduleNextFrame=function(){var a=this,b=d.now();a.lastTime=a.now||b,a.now=b,a.elapsed+=b-a.lastTime,a.lateTime=b-a.targetTime;var c=Math.max(0,1e3/a.pictureRate-a.lateTime);if(a.targetTime=b+c,a.fps){a.benchframe||(a.benchstart=b,a.benchframe=0),a.benchframe++;var e=b-a.benchstart;a.benchframe>=a.fps&&(a.benchfps=a.benchframe/e*1e3,a.benchframe=t,a.happen(C)),h(a.nextFrame.bind(a),1e3/a.fps)}else 18>c?a.scheduleAnimation():h(a.scheduleAnimation.bind(a),c)},b[D].scheduleFPSChange=function(a){function b(){e.fps=(a&&2>a?2:a)||t,e.targetTime=d.now()}function c(){e.dispel(C)}var e=this;c(),e.playing&&e.benchframe?(e.once(C,b),e.once(A,c)):b()},b[D].scheduleAnimation=function(){var a=this;g(a.nextFrame.bind(a),a.canvas)},b[D].decodeSequenceHeader=function(){var a=this;if(a.width=a.buffer.getBits(12),a.height=a.buffer.getBits(12),a.buffer.advance(4),a.pictureRate=F[a.buffer.getBits(4)],a.buffer.advance(30),a.initBuffers(),a.buffer.getBits(1)){for(var b=0;64>b;b++)a.customIntraQuantMatrix[G[b]]=a.buffer.getBits(8);a.intraQuantMatrix=a.customIntraQuantMatrix}if(a.buffer.getBits(1)){for(var b=0;64>b;b++)a.customNonIntraQuantMatrix[G[b]]=a.buffer.getBits(8);a.nonIntraQuantMatrix=a.customNonIntraQuantMatrix}},b[D].initBuffers=function(){var b=this;if(b.intraQuantMatrix=H,b.nonIntraQuantMatrix=I,b.mbWidth=b.width+15>>4,b.mbHeight=b.height+15>>4,b.mbSize=b.mbWidth*b.mbHeight,b.codedWidth=b.mbWidth<<4,b.codedHeight=b.mbHeight<<4,b.codedSize=b.codedWidth*b.codedHeight,b.halfWidth=b.mbWidth<<3,b.halfHeight=b.mbHeight<<3,b.quarterSize=b.codedSize>>2,!b.sequenceStarted){b.sequenceStarted=!0;var c=a.Uint8ClampedArray||m;a.Uint8ClampedArray||(b.copyBlockToDestination=b.copyBlockToDestinationClamp,b.addBlockToDestination=b.addBlockToDestinationClamp),b.currentY=new c(b.codedSize),b.currentY32=new n(b.currentY.buffer),b.currentCr=new c(b.codedSize>>2),b.currentCr32=new n(b.currentCr.buffer),b.currentCb=new c(b.codedSize>>2),b.currentCb32=new n(b.currentCb.buffer),b.forwardY=new c(b.codedSize),b.forwardY32=new n(b.forwardY.buffer),b.forwardCr=new c(b.codedSize>>2),b.forwardCr32=new n(b.forwardCr.buffer),b.forwardCb=new c(b.codedSize>>2),b.forwardCb32=new n(b.forwardCb.buffer),b.canvas.width=b.width,b.canvas.height=b.height,b.currentRGBA=b.canvasContext.getImageData(0,0,b.width,b.height),b.bwFilter&&(b.currentRGBA32=new n(b.currentRGBA.data.buffer)),b.fillArray(b.currentRGBA.data,255)}}}(q),function(a){a[D].decodePicture=function(a){var b=this;if(b.buffer.advance(10),b.pictureCodingType=b.buffer.getBits(3),b.buffer.advance(16),!(b.pictureCodingType<=0||b.pictureCodingType>=V)){if(b.pictureCodingType==U){if(b.fullPelForward=b.buffer.getBits(1),b.forwardFCode=b.buffer.getBits(3),0==b.forwardFCode)return;b.forwardRSize=b.forwardFCode-1,b.forwardF=1<<b.forwardRSize}var c=0;do c=b.buffer.findNextMPEGStartCode();while(c==$||c==_);for(;c>=X&&Y>=c;)b.decodeSlice(255&c),c=b.buffer.findNextMPEGStartCode();if(b.buffer.rewind(32),b.recordFrameFromCurrentBuffer(),a!=E&&(b.bwFilter?b.YToRGBA():b.YCbCrToRGBA(),b.canvasContext.putImageData(b.currentRGBA,0,0),b.happen(z,b.canvas)),b.pictureCodingType==T||b.pictureCodingType==U){var d=b.forwardY,e=b.forwardY32,f=b.forwardCr,g=b.forwardCr32,h=b.forwardCb,i=b.forwardCb32;b.forwardY=b.currentY,b.forwardY32=b.currentY32,b.forwardCr=b.currentCr,b.forwardCr32=b.currentCr32,b.forwardCb=b.currentCb,b.forwardCb32=b.currentCb32,b.currentY=d,b.currentY32=e,b.currentCr=f,b.currentCr32=g,b.currentCb=h,b.currentCb32=i}}},a[D].YCbCrToRGBA=function(){for(var a,b,c,d,e,f,g=this,h=g.currentY,i=g.currentCb,j=g.currentCr,k=g.currentRGBA.data,l=0,m=g.codedWidth,n=g.codedWidth+(g.codedWidth-g.width),o=0,p=g.halfWidth-(g.width>>1),q=0,r=4*g.width,s=4*g.width,t=g.width>>1,u=g.height>>1,v=0;u>v;v++){for(var w=0;t>w;w++)b=i[o],c=j[o],o++,d=c+(103*c>>8)-179,e=(88*b>>8)-44+(183*c>>8)-91,f=b+(198*b>>8)-227,a=h[l++],k[q]=a+d,k[q+1]=a-e,k[q+2]=a+f,q+=4,a=h[l++],k[q]=a+d,k[q+1]=a-e,k[q+2]=a+f,q+=4,a=h[m++],k[r]=a+d,k[r+1]=a-e,k[r+2]=a+f,r+=4,a=h[m++],k[r]=a+d,k[r+1]=a-e,k[r+2]=a+f,r+=4;l+=n,m+=n,q+=s,r+=s,o+=p}},a[D].YToRGBA=function(){for(var a,b=this,c=b.currentY,d=b.currentRGBA32,e=0,f=b.codedWidth-b.width,g=0,h=b.width,i=b.height,j=0;i>j;j++){for(var k=0;h>k;k++)a=c[e++],d[g++]=4278190080|a<<16|a<<8|a;e+=f}}}(q),function(a){a[D].decodeSlice=function(a){var b=this;for(b.sliceBegin=!0,b.macroblockAddress=(a-1)*b.mbWidth-1,b.motionFwH=b.motionFwHPrev=0,b.motionFwV=b.motionFwVPrev=0,b.dcPredictorY=128,b.dcPredictorCr=128,b.dcPredictorCb=128,b.quantizerScale=b.buffer.getBits(5);b.buffer.getBits(1);)b.buffer.advance(8);do b.decodeMacroblock();while(!b.buffer.nextBytesAreStartCode())}}(q),function(a){a[D].decodeMacroblock=function(){for(var a=this,b=0,c=a.readCode(K);34==c;)c=a.readCode(K);for(;35==c;)b+=33,c=a.readCode(K);if(b+=c,a.sliceBegin)a.sliceBegin=!1,a.macroblockAddress+=b;else{if(a.macroblockAddress+b>=a.mbSize)return;for(b>1&&(a.dcPredictorY=128,a.dcPredictorCr=128,a.dcPredictorCb=128,a.pictureCodingType==U&&(a.motionFwH=a.motionFwHPrev=0,a.motionFwV=a.motionFwVPrev=0));b>1;)a.macroblockAddress++,a.mbRow=a.macroblockAddress/a.mbWidth|0,a.mbCol=a.macroblockAddress%a.mbWidth,a.copyMacroblock(a.motionFwH,a.motionFwV,a.forwardY,a.forwardCr,a.forwardCb),b--;a.macroblockAddress++}a.mbRow=a.macroblockAddress/a.mbWidth|0,a.mbCol=a.macroblockAddress%a.mbWidth,a.macroblockType=a.readCode(ab[a.pictureCodingType]),a.macroblockIntra=1&a.macroblockType,a.macroblockMotFw=8&a.macroblockType,0!=(16&a.macroblockType)&&(a.quantizerScale=a.buffer.getBits(5)),a.macroblockIntra?(a.motionFwH=a.motionFwHPrev=0,a.motionFwV=a.motionFwVPrev=0):(a.dcPredictorY=128,a.dcPredictorCr=128,a.dcPredictorCb=128,a.decodeMotionVectors(),a.copyMacroblock(a.motionFwH,a.motionFwV,a.forwardY,a.forwardCr,a.forwardCb));for(var d=0!=(2&a.macroblockType)?a.readCode(O):a.macroblockIntra?63:0,e=0,f=32;6>e;e++)0!=(d&f)&&a.decodeBlock(e),f>>=1},a[D].decodeMotionVectors=function(){var a,b,c=this,d=0;c.macroblockMotFw?(a=c.readCode(P),0!=a&&1!=c.forwardF?(d=c.buffer.getBits(c.forwardRSize),b=(Math.abs(a)-1<<c.forwardRSize)+d+1,0>a&&(b=-b)):b=a,c.motionFwHPrev+=b,c.motionFwHPrev>(c.forwardF<<4)-1?c.motionFwHPrev-=c.forwardF<<5:c.motionFwHPrev<-c.forwardF<<4&&(c.motionFwHPrev+=c.forwardF<<5),c.motionFwH=c.motionFwHPrev,c.fullPelForward&&(c.motionFwH<<=1),a=c.readCode(P),0!=a&&1!=c.forwardF?(d=c.buffer.getBits(c.forwardRSize),b=(Math.abs(a)-1<<c.forwardRSize)+d+1,0>a&&(b=-b)):b=a,c.motionFwVPrev+=b,c.motionFwVPrev>(c.forwardF<<4)-1?c.motionFwVPrev-=c.forwardF<<5:c.motionFwVPrev<-c.forwardF<<4&&(c.motionFwVPrev+=c.forwardF<<5),c.motionFwV=c.motionFwVPrev,c.fullPelForward&&(c.motionFwV<<=1)):c.pictureCodingType==U&&(c.motionFwH=c.motionFwHPrev=0,c.motionFwV=c.motionFwVPrev=0)},a[D].copyMacroblock=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o=this,p=o.currentY32,q=o.currentCb32,r=o.currentCr32;f=o.codedWidth,g=f-16,h=a>>1,i=b>>1,j=1==(1&a),k=1==(1&b),l=((o.mbRow<<4)+i)*f+(o.mbCol<<4)+h,m=o.mbRow*f+o.mbCol<<2,n=m+(f<<2);var s,t,u;if(j)if(k)for(;n>m;){s=c[l]+c[l+f],l++;for(var v=0;4>v;v++)t=c[l]+c[l+f],l++,u=s+t+2>>2&255,s=c[l]+c[l+f],l++,u|=s+t+2<<6&65280,t=c[l]+c[l+f],l++,u|=s+t+2<<14&16711680,s=c[l]+c[l+f],l++,u|=s+t+2<<22&4278190080,p[m++]=u;m+=g>>2,l+=g-1}else for(;n>m;){s=c[l++];for(var v=0;4>v;v++)t=c[l++],u=s+t+1>>1&255,s=c[l++],u|=s+t+1<<7&65280,t=c[l++],u|=s+t+1<<15&16711680,s=c[l++],u|=s+t+1<<23&4278190080,p[m++]=u;m+=g>>2,l+=g-1}else if(k)for(;n>m;){for(var v=0;4>v;v++)u=c[l]+c[l+f]+1>>1&255,l++,u|=c[l]+c[l+f]+1<<7&65280,l++,u|=c[l]+c[l+f]+1<<15&16711680,l++,u|=c[l]+c[l+f]+1<<23&4278190080,l++,p[m++]=u;m+=g>>2,l+=g}else for(;n>m;){for(var v=0;4>v;v++)u=c[l],l++,u|=c[l]<<8,l++,u|=c[l]<<16,l++,u|=c[l]<<24,l++,p[m++]=u;m+=g>>2,l+=g}if(!o.bwFilter){f=o.halfWidth,g=f-8,h=a/2>>1,i=b/2>>1,j=1==(a/2&1),k=1==(b/2&1),l=((o.mbRow<<3)+i)*f+(o.mbCol<<3)+h,m=o.mbRow*f+o.mbCol<<1,n=m+(f<<1);var w,x,y,z,A,B;if(j)if(k)for(;n>m;){w=d[l]+d[l+f],z=e[l]+e[l+f],l++;for(var v=0;2>v;v++)x=d[l]+d[l+f],A=e[l]+e[l+f],l++,y=w+x+2>>2&255,B=z+A+2>>2&255,w=d[l]+d[l+f],z=e[l]+e[l+f],l++,y|=w+x+2<<6&65280,B|=z+A+2<<6&65280,x=d[l]+d[l+f],A=e[l]+e[l+f],l++,y|=w+x+2<<14&16711680,B|=z+A+2<<14&16711680,w=d[l]+d[l+f],z=e[l]+e[l+f],l++,y|=w+x+2<<22&4278190080,B|=z+A+2<<22&4278190080,r[m]=y,q[m]=B,m++;m+=g>>2,l+=g-1}else for(;n>m;){w=d[l],z=e[l],l++;for(var v=0;2>v;v++)x=d[l],A=e[l++],y=w+x+1>>1&255,B=z+A+1>>1&255,w=d[l],z=e[l++],y|=w+x+1<<7&65280,B|=z+A+1<<7&65280,x=d[l],A=e[l++],y|=w+x+1<<15&16711680,B|=z+A+1<<15&16711680,w=d[l],z=e[l++],y|=w+x+1<<23&4278190080,B|=z+A+1<<23&4278190080,r[m]=y,q[m]=B,m++;m+=g>>2,l+=g-1}else if(k)for(;n>m;){for(var v=0;2>v;v++)y=d[l]+d[l+f]+1>>1&255,B=e[l]+e[l+f]+1>>1&255,l++,y|=d[l]+d[l+f]+1<<7&65280,B|=e[l]+e[l+f]+1<<7&65280,l++,y|=d[l]+d[l+f]+1<<15&16711680,B|=e[l]+e[l+f]+1<<15&16711680,l++,y|=d[l]+d[l+f]+1<<23&4278190080,B|=e[l]+e[l+f]+1<<23&4278190080,l++,r[m]=y,q[m]=B,m++;m+=g>>2,l+=g}else for(;n>m;){for(var v=0;2>v;v++)y=d[l],B=e[l],l++,y|=d[l]<<8,B|=e[l]<<8,l++,y|=d[l]<<16,B|=e[l]<<16,l++,y|=d[l]<<24,B|=e[l]<<24,l++,r[m]=y,q[m]=B,m++;m+=g>>2,l+=g}}}}(q),function(a){a[D].decodeBlock=function(a){var b,c=this,d=0;if(c.fillArray(c.blockData,0),c.macroblockIntra){var e,f;if(4>a?(e=c.dcPredictorY,f=c.readCode(Q)):(e=4==a?c.dcPredictorCr:c.dcPredictorCb,f=c.readCode(R)),f>0){var g=c.buffer.getBits(f);c.blockData[0]=0!=(g&1<<f-1)?e+g:e+(-1<<f|g+1)}else c.blockData[0]=e;4>a?c.dcPredictorY=c.blockData[0]:4==a?c.dcPredictorCr=c.blockData[0]:c.dcPredictorCb=c.blockData[0],c.blockData[0]<<=8,b=c.intraQuantMatrix,d=1}else b=c.nonIntraQuantMatrix;for(var h=0;;){var i=0,j=c.readCode(S);if(1==j&&d>0&&0==c.buffer.getBits(1))break;65535==j?(i=c.buffer.getBits(6),h=c.buffer.getBits(8),0==h?h=c.buffer.getBits(8):128==h?h=c.buffer.getBits(8)-256:h>128&&(h-=256)):(i=j>>8,h=255&j,c.buffer.getBits(1)&&(h=-h)),d+=i;var k=G[d];d++,h<<=1,c.macroblockIntra||(h+=0>h?-1:1),h=h*c.quantizerScale*b[k]>>4,0==(1&h)&&(h-=h>0?1:-1),h>2047?h=2047:-2048>h&&(h=-2048),c.blockData[k]=h*J[k]}1==d?c.fillArray(c.blockData,c.blockData[0]+128>>8):c.IDCT();var l,m,n;4>a?(l=c.currentY,n=c.codedWidth-8,m=c.mbRow*c.codedWidth+c.mbCol<<4,0!=(1&a)&&(m+=8),0!=(2&a)&&(m+=c.codedWidth<<3)):(l=4==a?c.currentCb:c.currentCr,n=(c.codedWidth>>1)-8,m=(c.mbRow*c.codedWidth<<2)+(c.mbCol<<3)),d=0;c.blockData;c.macroblockIntra?c.copyBlockToDestination(c.blockData,l,m,n):c.addBlockToDestination(c.blockData,l,m,n)},a[D].copyBlockToDestination=function(a,b,c,d){for(var e=0,f=0;8>f;f++){for(var g=0;8>g;g++)b[c++]=a[e++];c+=d}},a[D].addBlockToDestination=function(a,b,c,d){for(var e=0,f=0;8>f;f++){for(var g=0;8>g;g++)b[c++]+=a[e++];c+=d}},a[D].copyBlockToDestinationClamp=function(a,b,c,d){for(var e=0,f=0;8>f;f++){for(var g=0;8>g;g++){var h=a[e++];b[c++]=h>255?255:0>h?0:h}c+=d}},a[D].addBlockToDestinationClamp=function(a,b,c,d){for(var e=0,f=0;8>f;f++){for(var g=0;8>g;g++){var h=a[e++]+b[c];b[c++]=h>255?255:0>h?0:h}c+=d}},a[D].IDCT=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this,u=t.blockData;for(s=0;8>s;++s)a=u[32+s],b=u[16+s]+u[48+s],c=u[40+s]-u[24+s],f=u[8+s]+u[56+s],g=u[24+s]+u[40+s],d=u[8+s]-u[56+s],e=f+g,h=u[0+s],m=(473*d-196*c+128>>8)-e,i=m-(362*(f-g)+128>>8),j=h-a,k=(362*(u[16+s]-u[48+s])+128>>8)-b,l=h+a,n=j+k,o=l+b,p=j-k,q=l-b,r=-i-(473*c+196*d+128>>8),u[0+s]=e+o,u[8+s]=m+n,u[16+s]=p-i,u[24+s]=q-r,u[32+s]=q+r,u[40+s]=i+p,u[48+s]=n-m,u[56+s]=o-e;for(s=0;64>s;s+=8)a=u[4+s],b=u[2+s]+u[6+s],c=u[5+s]-u[3+s],f=u[1+s]+u[7+s],g=u[3+s]+u[5+s],d=u[1+s]-u[7+s],e=f+g,h=u[0+s],m=(473*d-196*c+128>>8)-e,i=m-(362*(f-g)+128>>8),j=h-a,k=(362*(u[2+s]-u[6+s])+128>>8)-b,l=h+a,n=j+k,o=l+b,p=j-k,q=l-b,r=-i-(473*c+196*d+128>>8),u[0+s]=e+o+128>>8,u[1+s]=m+n+128>>8,u[2+s]=p-i+128>>8,u[3+s]=q-r+128>>8,u[4+s]=q+r+128>>8,u[5+s]=i+p+128>>8,u[6+s]=n-m+128>>8,u[7+s]=o-e+128>>8}}(q),function(a){a[D].onload=function(a){var b=this;return b.when(u,a)},a[D].timing=function(a){var b=this;return b.when(x,a)},a[D].tic=function(a){var b=this;return b.when(y,a)},a[D].ondecode=function(a){var b=this;return b.when(z,a)},a[D].onplay=function(a){var b=this;return b.when(v,a)},a[D].onpause=function(a){var b=this;return b.when(w,a)},a[D].onstop=function(a){var b=this;return b.when(A,a)},a[D].end=function(a){var b=this;return b.when(B,a)}}(q),s.NOT_FOUND=-1,s[D].findNextMPEGStartCode=function(){for(var a=this,b=a.index+7>>3;b<a.writePos;b++)if(0==a.bytes[b]&&0==a.bytes[b+1]&&1==a.bytes[b+2])return a.index=b+4<<3,a.bytes[b+3];return a.index=a.writePos<<3,s.NOT_FOUND},s[D].nextBytesAreStartCode=function(){var a=this,b=a.index+7>>3;return b>=a.writePos||0==a.bytes[b]&&0==a.bytes[b+1]&&1==a.bytes[b+2]},s[D].nextBits=function(a){var b=this,c=b.index>>3,d=8-b.index%8;if(d>=a)return b.bytes[c]>>d-a&255>>8-a;var e=(b.index+a)%8,f=b.index+a-1>>3,g=b.bytes[c]&255>>8-d;for(c++;f>c;c++)g<<=8,g|=b.bytes[c];return e>0?(g<<=e,g|=b.bytes[c]>>8-e):(g<<=8,g|=b.bytes[c]),g},s[D].getBits=function(a){var b=this,c=b.nextBits(a);return b.index+=a,c},s[D].advance=function(a){return this.index+=a},s[D].rewind=function(a){return this.index-=a},q}(window,document,Object,Date,XMLHttpRequest,Error,requestAnimationFrame,setTimeout,ArrayBuffer,Int8Array,Int16Array,Int32Array,Uint8Array,Uint32Array,Blob,MOJO);